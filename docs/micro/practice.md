# 实践出真理

在探寻合适的微前端方案的路上，我将上一章所提到的方案，全部实践了一遍，具体的 demo 案例代码，已经给到各项目组前端同事

优劣总结如下：

## 模块联邦 Module Federation

* 优点
    - 去中心化
    - 真正的微服务
    

* 缺点
    - 无法动态引入远程的模块
    - 产生了循环引用的问题
    - remote 方，开发模式下独立开发时热更新失效
    - 开发模式无法与生产模式交互

## 乾坤 + 模块联邦

 
* 优点
    - htmlEntry（不用关心 js 的 hash，可动态加载 js）
    - 集成迁移简单（以 html 为入口，完全不用关心子应用技术实现）
    - 沙箱隔离
    - 结合模块联邦，亦可做到模块互联

* 缺点
    - 模块互联需要结合模块联邦
    - 拥有模块联邦的所有缺点

## Single-spa

* 优点
    - 第三方依赖共享

* 缺点：
    - 第三方依赖共享
    - 以 js 为入口，只能加载固定的 js（需要关注子应用的实现，确定加载的js文件）
    - 无沙箱隔离
    - 各种引用

其他：
因为多个vue实例在同一个document里，需要避免全局变量污染、全局监听污染、样式污染等，需要制定接入规范。<br/>

使用了external抽离公共模块(比如Vue、Vue-router等)后，构造函数(或者Class)的污染也需要避免，比如Vue.mixin、Vue.components、Vue
.use等等都需要做一些额外的工作去避免它们产生冲突。<br/>

如果你也想要tab切换不刷新(使用keep-alive)，那需要做的工作更多，主要是处理缓存，防止堆内存溢出（用chrome自带的performance monitor查看），还有项目间切换时路由钩子等等的处理

## MicroApp

* 优点：
    - 集成简单
    - js沙箱、样式隔离、元素隔离、预加载、数据通信、静态资源补全
    - 体积小
    - 应用嵌套（多个子应用共存，业务组件复用）

* 缺点：
    - 社区目前不完善
    - 使用者需要对框架的路由（vue-router....）熟练
